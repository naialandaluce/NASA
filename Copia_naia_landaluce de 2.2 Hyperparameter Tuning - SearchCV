{"cells":[{"cell_type":"markdown","metadata":{"id":"eRfmgAGXKAfS"},"source":["# Hyperparameter tuning\n","\n","We are going to traing models using [this](https://www.kaggle.com/datasets/uciml/red-wine-quality-cortez-et-al-2009) dataset. The goal of this dataset is to predict the quality of wine based on several features/metrics:\n","\n","Input Variables (based on physicochemical tests):\n","*   Fixed acidity\n","*   Volatile acidity\n","*   Citric acid\n","*   Residual sugar\n","*   Chlorides\n","*   Free sulfur dioxide\n","*   Total sulfur dioxide\n","*   Density\n","*   pH\n","*   Sulphates\n","*   Alcohol\n","\n","Output Variable (based on sensory data):\n","*   Quality (score between 0 and 10)\n","\n","\n","The code and idea has been extracted from this [post](https://www.kdnuggets.com/2022/10/hyperparameter-tuning-grid-search-random-search-python.html).\n"]},{"cell_type":"code","execution_count":4,"metadata":{"executionInfo":{"elapsed":19,"status":"ok","timestamp":1741372274131,"user":{"displayName":"Naia Landaluce Marquínez","userId":"06454318205909879323"},"user_tz":-60},"id":"sJ1uH58u4Am2"},"outputs":[],"source":["import pandas as pd\n","from pydrive2.auth import GoogleAuth\n","from pydrive2.drive import GoogleDrive\n","from google.colab import auth\n","from oauth2client.client import GoogleCredentials\n"]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":22059,"status":"ok","timestamp":1741372330010,"user":{"displayName":"Naia Landaluce Marquínez","userId":"06454318205909879323"},"user_tz":-60},"id":"dVCUx9hW4-IS","outputId":"19167cfa-591e-41f5-e283-b75fdac52c01"},"outputs":[{"name":"stdout","output_type":"stream","text":["      fixed acidity  volatile acidity  citric acid  residual sugar  chlorides  \\\n","0               7.4             0.700         0.00             1.9      0.076   \n","1               7.8             0.880         0.00             2.6      0.098   \n","2               7.8             0.760         0.04             2.3      0.092   \n","3              11.2             0.280         0.56             1.9      0.075   \n","4               7.4             0.700         0.00             1.9      0.076   \n","...             ...               ...          ...             ...        ...   \n","1594            6.2             0.600         0.08             2.0      0.090   \n","1595            5.9             0.550         0.10             2.2      0.062   \n","1596            6.3             0.510         0.13             2.3      0.076   \n","1597            5.9             0.645         0.12             2.0      0.075   \n","1598            6.0             0.310         0.47             3.6      0.067   \n","\n","      free sulfur dioxide  total sulfur dioxide  density    pH  sulphates  \\\n","0                    11.0                  34.0  0.99780  3.51       0.56   \n","1                    25.0                  67.0  0.99680  3.20       0.68   \n","2                    15.0                  54.0  0.99700  3.26       0.65   \n","3                    17.0                  60.0  0.99800  3.16       0.58   \n","4                    11.0                  34.0  0.99780  3.51       0.56   \n","...                   ...                   ...      ...   ...        ...   \n","1594                 32.0                  44.0  0.99490  3.45       0.58   \n","1595                 39.0                  51.0  0.99512  3.52       0.76   \n","1596                 29.0                  40.0  0.99574  3.42       0.75   \n","1597                 32.0                  44.0  0.99547  3.57       0.71   \n","1598                 18.0                  42.0  0.99549  3.39       0.66   \n","\n","      alcohol  \n","0         9.4  \n","1         9.8  \n","2         9.8  \n","3         9.8  \n","4         9.4  \n","...       ...  \n","1594     10.5  \n","1595     11.2  \n","1596     11.0  \n","1597     10.2  \n","1598     11.0  \n","\n","[1599 rows x 11 columns]\n","      target\n","0          0\n","1          0\n","2          0\n","3          1\n","4          0\n","...      ...\n","1594       0\n","1595       1\n","1596       1\n","1597       0\n","1598       1\n","\n","[1599 rows x 1 columns]\n"]}],"source":["\n","auth.authenticate_user()\n","gauth = GoogleAuth()\n","gauth.credentials = GoogleCredentials.get_application_default()\n","drive = GoogleDrive(gauth)\n","\n","#Google Drive ID for public sharing of the dataset\n","file_id = \"1Ck8dPieQkF2K9T6NI-vaxPe3drYEA1CZ\"\n","file = drive.CreateFile({'id': file_id})\n","file.GetContentFile('winequality-red.csv')\n","\n","#Reading the csv and loading it into a pandas dataframe.\n","df = pd.read_csv('winequality-red.csv')\n","df.head()\n","\n","import numpy as np\n","\n","#We transform the problem from a regression to a binary: good \u003e 5, bad \u003c= 5.\n","df['target'] = np.where(df['quality']\u003e5, 1, 0)\n","\n","#We delete the quality columns since we have already used it for the definition of the target/y.\n","df2 = df.drop(['quality'],axis=1)\n","#We remove the target from the dataframe. We do not want data leakage!!\n","X = df2.drop(['target'],axis=1)\n","#We only keep the label.\n","y = df2[['target']]\n","\n","print(X)\n","print(y)"]},{"cell_type":"markdown","metadata":{"id":"KY121NMRRvo2"},"source":["Once the dataset has been processed, we are going to choose a classifier and create a python dictionary with the different possible hyperparameter values.  "]},{"cell_type":"code","execution_count":6,"metadata":{"executionInfo":{"elapsed":1646,"status":"ok","timestamp":1741372360539,"user":{"displayName":"Naia Landaluce Marquínez","userId":"06454318205909879323"},"user_tz":-60},"id":"DK1UStBF5lSV"},"outputs":[],"source":["from sklearn.ensemble import RandomForestClassifier\n","\n","rf = RandomForestClassifier()"]},{"cell_type":"code","execution_count":7,"metadata":{"executionInfo":{"elapsed":6,"status":"ok","timestamp":1741372363306,"user":{"displayName":"Naia Landaluce Marquínez","userId":"06454318205909879323"},"user_tz":-60},"id":"S9fgUC3A7GsH"},"outputs":[],"source":["grid_space={'max_depth':[3,5,10,None],\n","              'n_estimators':[10,100,200],\n","              'max_features':[1,3,5,7],\n","              'min_samples_leaf':[1,2,3],\n","              'min_samples_split':[2,3]\n","           }"]},{"cell_type":"markdown","metadata":{"id":"5N_MQQ_XTq11"},"source":["## GridSearchCV\n","\n","Now, let's search for the best combination of hyperameters withing the parameter grid.\n","\n","Parameters to take into account:\n","*   ***cv***: number of cross-validation folds used for the hyperparameter search.\n","*   ***scoring***: which metric we are aiming to maximize. [Here](https://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter) the list of all possible metrics.\n","*   ***refit***: this way, once the best parameters have been found, a model with the whole dataset is trained with the correct parameters. Therefore, ***best_estimator_*** is avaiable.\n","*   ***verbose***: information messages are shown.\n","\n"]},{"cell_type":"code","execution_count":8,"metadata":{"executionInfo":{"elapsed":302750,"status":"ok","timestamp":1741372676452,"user":{"displayName":"Naia Landaluce Marquínez","userId":"06454318205909879323"},"user_tz":-60},"id":"GmjNFMjp7J9F"},"outputs":[],"source":["from sklearn.model_selection import GridSearchCV\n","\n","grid = GridSearchCV(rf,param_grid=grid_space,cv=3,scoring='accuracy')\n","model_grid = grid.fit(X,y.values.ravel())"]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":30,"status":"ok","timestamp":1741372852354,"user":{"displayName":"Naia Landaluce Marquínez","userId":"06454318205909879323"},"user_tz":-60},"id":"Z_9Wy1sl7L92","outputId":"d267341b-e3cd-438f-a99c-834beabe4dae"},"outputs":[{"name":"stdout","output_type":"stream","text":["Best hyperparameters according to GridSearchCV are: {'max_depth': 3, 'max_features': 3, 'min_samples_leaf': 3, 'min_samples_split': 3, 'n_estimators': 100}\n","Best score (in this case accuracy) according to GridSearchCV is: 0.7360850531582238\n","The best estimator can be accessed using best_estimator_ :RandomForestClassifier(max_depth=3, max_features=3, min_samples_leaf=3,\n","                       min_samples_split=3)\n"]}],"source":["print(\"Best hyperparameters according to GridSearchCV are: \"+str(model_grid.best_params_))\n","print(\"Best score (in this case accuracy) according to GridSearchCV is: \"+str(model_grid.best_score_))\n","print(\"The best estimator can be accessed using best_estimator_ :\" + str(model_grid.best_estimator_))"]},{"cell_type":"markdown","metadata":{"id":"pD87AE_qFbdy"},"source":["## Visualizing grid results using a heatmap\n","\n","In order to facilitate its visualization, we are going to focus in two hyperparameters: number of estimators and maximum number of features."]},{"cell_type":"code","execution_count":10,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":499},"executionInfo":{"elapsed":17692,"status":"ok","timestamp":1741372954687,"user":{"displayName":"Naia Landaluce Marquínez","userId":"06454318205909879323"},"user_tz":-60},"id":"AUnZBd2gFqJx","outputId":"2a04be3b-259e-4e72-af91-97664dd7b0e2"},"outputs":[{"data":{"image/png":"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smk6JknCji0RERER6QV2bImIiIgk0sYDFfiABulY2BIRERFJxeW+dAqnIhARERGRXmDHloiIiEgimSBApuGbvTQdryZhx5aIiIiI9AI7tkRERERSKf9/03RMkoQdWyIiIiLSC+zYEhEREUnEOba6hR1bIiIiItIL7NgSERERScV1bHUKC1siIiIiqQThyabpmCQJpyIQERERkV5gx5aIiIhIIpnwZNN0TJKGHVsiIiIi0gvs2BIRERFJxTm2OoUdWyIiIiLSC+zYEhEREUkkUz7ZNB2TpGHHloiIiIj0Aju2RERERFJxjq1OYWFLREREJBWfPKZTOBWBiIiIiPQCO7ZEREREEskEATINTx3QdLyahB1bIiIiItIL7NgSERERScWbx3QKO7ZEREREpBfYsSUiIiKSSgCg6QcqsGErGTu2RERERKQX2LElIiIikoirIugWFrZEREREUgnQws1jmg1Xk3AqAhERERHpBXZsiYiIiKTicl86hR1bIiIiItIL7NgSERERSaUEINNCTJKEHVsiIiKiai4iIgKurq4wMTGBt7c3Tpw48czjc3JyEBwcDAcHBxgbG6NZs2b4+eefxf0PHz7ErFmz4OLiAlNTU3Tq1AknT55UiSEIAkJDQ+Hg4ABTU1P4+vriypUrWnl/FcXCloiIiEii0uW+NL2pY+vWrQgJCUFYWBhOnz4NT09P+Pn54d69e+UeX1RUhD59+uDmzZvYvn070tLS8PXXX8PJyUk85o033sD+/fuxadMmnDt3Dn379oWvry/++OMP8Zjly5cjPDwckZGRSEpKgpmZGfz8/FBQUCDtw9QAFrZERERE1diKFSswadIkjB8/Hi1btkRkZCRq166NdevWlXv8unXrkJ2djR07dqBz585wdXVF9+7d4enpCQD4+++/8cMPP2D58uXo1q0bmjRpgsWLF6NJkyZYu3YtgCfd2lWrVmHhwoUYMmQI2rRpg40bN+Lu3bvYsWNHZb31MljYEhEREUlVuiqCprcKKioqQnJyMnx9fcUxuVwOX19fJCYmlnvOzp074ePjg+DgYNjZ2aF169b46KOPoFAoAAAlJSVQKBQwMTFROc/U1BRHjx4FANy4cQOZmZkq17W0tIS3t/dTr1sZePMYERERkVRaXO4rLy9PZdjY2BjGxsYqYw8ePIBCoYCdnZ3KuJ2dHS5dulRu+OvX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\n","text/plain":["\u003cFigure size 800x600 with 2 Axes\u003e"]},"metadata":{},"output_type":"display_data"}],"source":["grid_space={'n_estimators':[10,100,200],'max_features':[1,3,5,7]}\n","\n","grid = GridSearchCV(rf,param_grid=grid_space,cv=3,scoring='accuracy')\n","model_grid = grid.fit(X,y.values.ravel())\n","\n","#Extracted from https://pieriantraining.com/gridsearchcv-with-scikit-learn-and-python/\n","import matplotlib.pyplot as plt\n","# Visualize grid search results using a heatmap\n","mean_scores = model_grid.cv_results_['mean_test_score']\n","mean_scores = np.array(mean_scores).reshape(len(grid_space['n_estimators']), len(grid_space['max_features']))\n","\n","plt.figure(figsize=(8, 6))\n","plt.imshow(mean_scores, interpolation='nearest', cmap='viridis')\n","plt.title('Grid Search Mean Test Scores', fontsize=16)\n","plt.xlabel('Max Features')\n","plt.ylabel('Number estimators')\n","plt.xticks(np.arange(len(grid_space['max_features'])), grid_space['max_features'])\n","plt.yticks(np.arange(len(grid_space['n_estimators'])), grid_space['n_estimators'])\n","plt.colorbar(label='Mean Test Score')\n","plt.show()"]},{"cell_type":"markdown","metadata":{"id":"FQzW206WdX_p"},"source":["## RandomSearchCV\n","\n","For large data sets, it is impossible to try every combination of models and parameters.\n","So instead we use heuristics, which do not guarantee the best model but tend to work well in practice."]},{"cell_type":"code","execution_count":11,"metadata":{"executionInfo":{"elapsed":5,"status":"ok","timestamp":1741373525167,"user":{"displayName":"Naia Landaluce Marquínez","userId":"06454318205909879323"},"user_tz":-60},"id":"obVh9yvO7Qtn"},"outputs":[],"source":["from scipy.stats import randint\n","\n","rs_space={'max_depth':list(np.arange(10, 100, step=10)) + [None],\n","              'n_estimators':np.arange(10, 500, step=50),\n","              'max_features':randint(1,7),\n","              'criterion':['gini','entropy'],\n","              'min_samples_leaf':randint(1,4),\n","              'min_samples_split':np.arange(2, 10, step=2)\n","         }"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"PsJtehIS7TAl"},"outputs":[],"source":["from sklearn.model_selection import RandomizedSearchCV\n","\n","rf = RandomForestClassifier()\n","rf_random = RandomizedSearchCV(rf, rs_space, n_iter=500, scoring='accuracy', n_jobs=-1, cv=3)\n","model_random = rf_random.fit(X,y.values.ravel())"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"8hUYMut67W5f"},"outputs":[{"name":"stdout","output_type":"stream","text":["Best hyperparameters are: {'criterion': 'gini', 'max_depth': 10, 'max_features': 6, 'min_samples_leaf': 3, 'min_samples_split': 4, 'n_estimators': 360}\n","Best score is: 0.7335834896810507\n"]}],"source":["print('Best hyperparameters are: '+str(model_random.best_params_))\n","print('Best score is: '+str(model_random.best_score_))"]},{"cell_type":"markdown","metadata":{"id":"KLFtBY95giI9"},"source":["**Exercise 1:** Create an ensemble learning model where both the hyperparameters of the ensemble method and the hyperparameters of the individual models within it are optimized."]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"NeiK1OVtHjFt"},"outputs":[{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.11/dist-packages/sklearn/utils/validation.py:1408: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().\n","  y = column_or_1d(y, warn=True)\n"]},{"name":"stdout","output_type":"stream","text":["Best hyperparameters: {'estimator__max_depth': 5, 'estimator__min_samples_split': 6, 'learning_rate': 1, 'n_estimators': 50}\n","Test set score: 0.7958333333333333\n"]}],"source":["from sklearn.model_selection import GridSearchCV\n","from sklearn.ensemble import AdaBoostClassifier\n","from sklearn.tree import DecisionTreeClassifier\n","from sklearn.datasets import make_classification\n","from sklearn.model_selection import train_test_split\n","\n","# Split dataset into training and testing\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)\n","\n","# Create a Decision Tree Classifier model\n","decision_tree = DecisionTreeClassifier(random_state=42)\n","\n","# Create an AdaBoostClassifier with Decision Tree as the base estimator\n","ada_boost = AdaBoostClassifier(estimator=decision_tree)\n","\n","# Define a grid of hyperparameters to search (for both AdaBoost and Decision Tree)\n","param_grid = {\n","    'estimator__max_depth': [1, 2, 3, 4, 5],  # Decision Tree hyperparameter\n","    'estimator__min_samples_split': [2, 4, 6],  # Decision Tree hyperparameter\n","    'n_estimators': [50, 100, 200],  # AdaBoost hyperparameter\n","    'learning_rate': [0.01, 0.1, 1]  # AdaBoost hyperparameter\n","}\n","\n","# Setup the grid search\n","grid_search = GridSearchCV(estimator=ada_boost, param_grid=param_grid, cv=5, n_jobs=-1)\n","\n","# Perform the grid search on the training data\n","grid_search.fit(X_train, y_train)\n","\n","# Best hyperparameter combination\n","print(\"Best hyperparameters:\", grid_search.best_params_)\n","\n","# Evaluate on the test set\n","test_score = grid_search.score(X_test, y_test)\n","print(\"Test set score:\", test_score)"]},{"cell_type":"markdown","metadata":{"id":"K-J20OcrE0iC"},"source":["**Exercise 2:** Perform a hyperparameter tuning of a SVC and RandomForest with Optuna with the previous dataset. Example: https://github.com/optuna/optuna-examples/blob/main/sklearn/sklearn_additional_args.py"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5455,"status":"ok","timestamp":1741173949465,"user":{"displayName":"Aritz Bilbao Jayo","userId":"07337047788957255346"},"user_tz":-60},"id":"QGKYPjz_EwwC","outputId":"c96b9f29-2bc0-459d-c322-665597ad6f2b"},"outputs":[{"name":"stdout","output_type":"stream","text":["Collecting optuna\n","  Downloading optuna-4.2.1-py3-none-any.whl.metadata (17 kB)\n","Collecting alembic\u003e=1.5.0 (from optuna)\n","  Downloading alembic-1.15.1-py3-none-any.whl.metadata (7.2 kB)\n","Collecting colorlog (from optuna)\n","  Downloading colorlog-6.9.0-py3-none-any.whl.metadata (10 kB)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.11/dist-packages (from optuna) (1.26.4)\n","Requirement already satisfied: packaging\u003e=20.0 in /usr/local/lib/python3.11/dist-packages (from optuna) (24.2)\n","Requirement already satisfied: sqlalchemy\u003e=1.4.2 in /usr/local/lib/python3.11/dist-packages (from optuna) (2.0.38)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.11/dist-packages (from optuna) (4.67.1)\n","Requirement already satisfied: PyYAML in /usr/local/lib/python3.11/dist-packages (from optuna) (6.0.2)\n","Collecting Mako (from alembic\u003e=1.5.0-\u003eoptuna)\n","  Downloading Mako-1.3.9-py3-none-any.whl.metadata (2.9 kB)\n","Requirement already satisfied: typing-extensions\u003e=4.12 in /usr/local/lib/python3.11/dist-packages (from alembic\u003e=1.5.0-\u003eoptuna) (4.12.2)\n","Requirement already satisfied: greenlet!=0.4.17 in /usr/local/lib/python3.11/dist-packages (from sqlalchemy\u003e=1.4.2-\u003eoptuna) (3.1.1)\n","Requirement already satisfied: MarkupSafe\u003e=0.9.2 in /usr/local/lib/python3.11/dist-packages (from Mako-\u003ealembic\u003e=1.5.0-\u003eoptuna) (3.0.2)\n","Downloading optuna-4.2.1-py3-none-any.whl (383 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m383.6/383.6 kB\u001b[0m \u001b[31m7.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading alembic-1.15.1-py3-none-any.whl (231 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m231.8/231.8 kB\u001b[0m \u001b[31m15.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading colorlog-6.9.0-py3-none-any.whl (11 kB)\n","Downloading Mako-1.3.9-py3-none-any.whl (78 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m78.5/78.5 kB\u001b[0m \u001b[31m4.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: Mako, colorlog, alembic, optuna\n","Successfully installed Mako-1.3.9 alembic-1.15.1 colorlog-6.9.0 optuna-4.2.1\n"]}],"source":["!pip install optuna"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":74329,"status":"ok","timestamp":1741174035165,"user":{"displayName":"Aritz Bilbao Jayo","userId":"07337047788957255346"},"user_tz":-60},"id":"pCcJd5ZxM4Se","outputId":"4ee38c83-f09a-4e94-967f-8b193e3cab74"},"outputs":[{"name":"stderr","output_type":"stream","text":["[I 2025-03-05 11:25:25,408] A new study created in memory with name: no-name-88c999bd-3cde-472b-9818-ad6d6c8ec137\n","[I 2025-03-05 11:25:27,653] Trial 0 finished with value: 0.7810545129579981 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 9, 'n_estimators': 97}. Best is trial 0 with value: 0.7810545129579981.\n","[I 2025-03-05 11:25:29,017] Trial 1 finished with value: 0.774798927613941 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 10, 'n_estimators': 69}. Best is trial 0 with value: 0.7810545129579981.\n","[I 2025-03-05 11:25:29,528] Trial 2 finished with value: 0.6711349419124218 and parameters: {'classifier': 'SVC', 'svc_c': 100914570.29358529}. Best is trial 0 with value: 0.7810545129579981.\n","[I 2025-03-05 11:25:30,159] Trial 3 finished with value: 0.6711349419124218 and parameters: {'classifier': 'SVC', 'svc_c': 31059292.87192098}. Best is trial 0 with value: 0.7810545129579981.\n","[I 2025-03-05 11:25:30,706] Trial 4 finished with value: 0.5254691689008043 and parameters: {'classifier': 'SVC', 'svc_c': 0.001059668956790297}. Best is trial 0 with value: 0.7810545129579981.\n","[I 2025-03-05 11:25:32,214] Trial 5 finished with value: 0.7864164432529045 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 10, 'n_estimators': 61}. Best is trial 5 with value: 0.7864164432529045.\n","[I 2025-03-05 11:25:34,605] Trial 6 finished with value: 0.7890974084003575 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 17, 'n_estimators': 97}. Best is trial 6 with value: 0.7890974084003575.\n","[I 2025-03-05 11:25:36,036] Trial 7 finished with value: 0.7873100983020554 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 23, 'n_estimators': 96}. Best is trial 6 with value: 0.7890974084003575.\n","[I 2025-03-05 11:25:37,221] Trial 8 finished with value: 0.7801608579088471 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 8, 'n_estimators': 48}. Best is trial 6 with value: 0.7890974084003575.\n","[I 2025-03-05 11:25:37,752] Trial 9 finished with value: 0.5254691689008043 and parameters: {'classifier': 'SVC', 'svc_c': 9.685938793956244e-10}. Best is trial 6 with value: 0.7890974084003575.\n","[I 2025-03-05 11:25:38,227] Trial 10 finished with value: 0.738159070598749 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 2, 'n_estimators': 14}. Best is trial 6 with value: 0.7890974084003575.\n","[I 2025-03-05 11:25:40,390] Trial 11 finished with value: 0.7917783735478104 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 31, 'n_estimators': 98}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:42,066] Trial 12 finished with value: 0.7855227882037533 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 30, 'n_estimators': 100}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:43,034] Trial 13 finished with value: 0.7792672028596961 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 19, 'n_estimators': 82}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:44,287] Trial 14 finished with value: 0.7819481680071493 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 17, 'n_estimators': 78}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:44,751] Trial 15 finished with value: 0.7488829311885613 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 3, 'n_estimators': 36}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:45,940] Trial 16 finished with value: 0.7864164432529043 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 30, 'n_estimators': 85}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:46,611] Trial 17 finished with value: 0.7837354781054513 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 15, 'n_estimators': 48}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:46,862] Trial 18 finished with value: 0.6738159070598749 and parameters: {'classifier': 'SVC', 'svc_c': 7.162748163659587}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:47,952] Trial 19 finished with value: 0.7587131367292225 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 5, 'n_estimators': 88}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:49,047] Trial 20 finished with value: 0.7703306523681858 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 14, 'n_estimators': 71}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:51,309] Trial 21 finished with value: 0.7846291331546023 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 24, 'n_estimators': 99}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:52,873] Trial 22 finished with value: 0.7792672028596962 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 22, 'n_estimators': 91}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:53,599] Trial 23 finished with value: 0.7864164432529043 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 32, 'n_estimators': 90}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:54,168] Trial 24 finished with value: 0.7890974084003575 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 13, 'n_estimators': 76}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:54,752] Trial 25 finished with value: 0.7890974084003575 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 13, 'n_estimators': 74}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:54,910] Trial 26 finished with value: 0.5254691689008043 and parameters: {'classifier': 'SVC', 'svc_c': 4.230434770002666e-09}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:55,346] Trial 27 finished with value: 0.7685433422698837 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 6, 'n_estimators': 64}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:55,943] Trial 28 finished with value: 0.7783735478105451 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 13, 'n_estimators': 79}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:56,629] Trial 29 finished with value: 0.7864164432529043 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 18, 'n_estimators': 89}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:57,077] Trial 30 finished with value: 0.7792672028596961 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 12, 'n_estimators': 58}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:57,530] Trial 31 finished with value: 0.7756925826630919 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 6, 'n_estimators': 69}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:58,115] Trial 32 finished with value: 0.7801608579088471 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 12, 'n_estimators': 76}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:58,825] Trial 33 finished with value: 0.7783735478105451 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 23, 'n_estimators': 93}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:59,185] Trial 34 finished with value: 0.7587131367292225 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 4, 'n_estimators': 52}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:59,372] Trial 35 finished with value: 0.6738159070598749 and parameters: {'classifier': 'SVC', 'svc_c': 97.43129861742608}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:25:59,940] Trial 36 finished with value: 0.7855227882037533 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 16, 'n_estimators': 74}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:26:00,108] Trial 37 finished with value: 0.5254691689008043 and parameters: {'classifier': 'SVC', 'svc_c': 0.0001433980693323795}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:26:00,419] Trial 38 finished with value: 0.7819481680071493 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 9, 'n_estimators': 39}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:26:01,052] Trial 39 finished with value: 0.7864164432529043 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 19, 'n_estimators': 84}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:26:01,257] Trial 40 finished with value: 0.6711349419124218 and parameters: {'classifier': 'SVC', 'svc_c': 4856.448210496839}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:26:01,960] Trial 41 finished with value: 0.7873100983020554 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 25, 'n_estimators': 95}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:26:02,678] Trial 42 finished with value: 0.7873100983020554 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 26, 'n_estimators': 97}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:26:03,625] Trial 43 finished with value: 0.7801608579088471 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 11, 'n_estimators': 100}. Best is trial 11 with value: 0.7917783735478104.\n","[I 2025-03-05 11:26:04,509] Trial 44 finished with value: 0.7926720285969616 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 22, 'n_estimators': 65}. Best is trial 44 with value: 0.7926720285969616.\n","[I 2025-03-05 11:26:05,367] Trial 45 finished with value: 0.7765862377122431 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 21, 'n_estimators': 66}. Best is trial 44 with value: 0.7926720285969616.\n","[I 2025-03-05 11:26:06,054] Trial 46 finished with value: 0.7792672028596961 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 9, 'n_estimators': 60}. Best is trial 44 with value: 0.7926720285969616.\n","[I 2025-03-05 11:26:06,615] Trial 47 finished with value: 0.7676496872207328 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 15, 'n_estimators': 74}. Best is trial 44 with value: 0.7926720285969616.\n","[I 2025-03-05 11:26:07,115] Trial 48 finished with value: 0.7810545129579981 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 29, 'n_estimators': 64}. Best is trial 44 with value: 0.7926720285969616.\n","[I 2025-03-05 11:26:07,713] Trial 49 finished with value: 0.7855227882037533 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 20, 'n_estimators': 81}. Best is trial 44 with value: 0.7926720285969616.\n","[I 2025-03-05 11:26:08,141] Trial 50 finished with value: 0.7810545129579981 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 10, 'n_estimators': 54}. Best is trial 44 with value: 0.7926720285969616.\n","[I 2025-03-05 11:26:08,258] Trial 51 finished with value: 0.7578194816800714 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 26, 'n_estimators': 10}. Best is trial 44 with value: 0.7926720285969616.\n","[I 2025-03-05 11:26:08,896] Trial 52 finished with value: 0.7917783735478104 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 17, 'n_estimators': 86}. Best is trial 44 with value: 0.7926720285969616.\n","[I 2025-03-05 11:26:09,553] Trial 53 finished with value: 0.7828418230563002 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 17, 'n_estimators': 85}. Best is trial 44 with value: 0.7926720285969616.\n","[I 2025-03-05 11:26:10,073] Trial 54 finished with value: 0.7980339588918678 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 13, 'n_estimators': 69}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:10,471] Trial 55 finished with value: 0.7462019660411081 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 2, 'n_estimators': 68}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:10,627] Trial 56 finished with value: 0.5254691689008043 and parameters: {'classifier': 'SVC', 'svc_c': 4.587594340744793e-05}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:11,289] Trial 57 finished with value: 0.7908847184986595 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 16, 'n_estimators': 87}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:11,982] Trial 58 finished with value: 0.7774798927613941 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 17, 'n_estimators': 95}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:12,646] Trial 59 finished with value: 0.7882037533512064 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 20, 'n_estimators': 87}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:12,853] Trial 60 finished with value: 0.7864164432529043 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 28, 'n_estimators': 22}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:13,546] Trial 61 finished with value: 0.7783735478105451 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 11, 'n_estimators': 93}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:14,164] Trial 62 finished with value: 0.7810545129579981 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 14, 'n_estimators': 82}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:14,717] Trial 63 finished with value: 0.7837354781054513 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 16, 'n_estimators': 71}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:15,308] Trial 64 finished with value: 0.7882037533512064 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 22, 'n_estimators': 78}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:16,032] Trial 65 finished with value: 0.7819481680071493 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 14, 'n_estimators': 91}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:17,066] Trial 66 finished with value: 0.7846291331546023 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 32, 'n_estimators': 87}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:18,037] Trial 67 finished with value: 0.7765862377122431 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 18, 'n_estimators': 81}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:18,374] Trial 68 finished with value: 0.6711349419124218 and parameters: {'classifier': 'SVC', 'svc_c': 146072.1895919368}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:19,405] Trial 69 finished with value: 0.7774798927613941 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 8, 'n_estimators': 100}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:20,120] Trial 70 finished with value: 0.7890974084003575 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 13, 'n_estimators': 96}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:20,678] Trial 71 finished with value: 0.7890974084003575 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 12, 'n_estimators': 74}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:21,256] Trial 72 finished with value: 0.7846291331546023 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 15, 'n_estimators': 77}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:21,757] Trial 73 finished with value: 0.7864164432529043 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 13, 'n_estimators': 62}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:22,298] Trial 74 finished with value: 0.7792672028596962 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 10, 'n_estimators': 72}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:22,825] Trial 75 finished with value: 0.7828418230563002 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 23, 'n_estimators': 68}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:23,496] Trial 76 finished with value: 0.7935656836461126 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 18, 'n_estimators': 91}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:24,199] Trial 77 finished with value: 0.7917783735478104 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 19, 'n_estimators': 93}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:24,916] Trial 78 finished with value: 0.7855227882037533 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 19, 'n_estimators': 93}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:25,126] Trial 79 finished with value: 0.6711349419124218 and parameters: {'classifier': 'SVC', 'svc_c': 6844755646.089116}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:26,030] Trial 80 finished with value: 0.7801608579088471 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 25, 'n_estimators': 89}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:26,753] Trial 81 finished with value: 0.7855227882037533 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 16, 'n_estimators': 97}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:27,406] Trial 82 finished with value: 0.7837354781054513 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 21, 'n_estimators': 85}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:28,113] Trial 83 finished with value: 0.7864164432529043 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 18, 'n_estimators': 93}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:28,802] Trial 84 finished with value: 0.7971403038427166 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 20, 'n_estimators': 91}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:29,593] Trial 85 finished with value: 0.7882037533512064 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 27, 'n_estimators': 90}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:30,797] Trial 86 finished with value: 0.7837354781054513 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 20, 'n_estimators': 99}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:31,897] Trial 87 finished with value: 0.7810545129579981 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 23, 'n_estimators': 92}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:32,727] Trial 88 finished with value: 0.7882037533512064 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 17, 'n_estimators': 87}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:33,117] Trial 89 finished with value: 0.7810545129579981 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 21, 'n_estimators': 49}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:33,745] Trial 90 finished with value: 0.7846291331546023 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 24, 'n_estimators': 83}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:34,468] Trial 91 finished with value: 0.7855227882037533 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 19, 'n_estimators': 96}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:34,905] Trial 92 finished with value: 0.7533512064343163 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 3, 'n_estimators': 80}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:35,581] Trial 93 finished with value: 0.7864164432529043 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 15, 'n_estimators': 89}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:36,266] Trial 94 finished with value: 0.7873100983020554 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 11, 'n_estimators': 94}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:36,984] Trial 95 finished with value: 0.7855227882037533 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 14, 'n_estimators': 98}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:37,641] Trial 96 finished with value: 0.7792672028596962 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 30, 'n_estimators': 86}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:37,803] Trial 97 finished with value: 0.5254691689008043 and parameters: {'classifier': 'SVC', 'svc_c': 0.023063121345352506}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:38,485] Trial 98 finished with value: 0.7935656836461126 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 17, 'n_estimators': 90}. Best is trial 54 with value: 0.7980339588918678.\n","[I 2025-03-05 11:26:38,929] Trial 99 finished with value: 0.7873100983020554 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 18, 'n_estimators': 58}. Best is trial 54 with value: 0.7980339588918678.\n"]},{"name":"stdout","output_type":"stream","text":["Best parameters: {'classifier': 'RandomForest', 'rf_max_depth': 13, 'n_estimators': 69}\n"]}],"source":["import optuna\n","\n","import sklearn.datasets\n","import sklearn.ensemble\n","import sklearn.model_selection\n","import sklearn.svm\n","\n","\n","def objective(trial):\n","\n","    classifier_name = trial.suggest_categorical(\"classifier\", [\"SVC\", \"RandomForest\"])\n","    if classifier_name == \"SVC\":\n","        svc_c = trial.suggest_float(\"svc_c\", 1e-10, 1e10, log=True)\n","        classifier_obj = sklearn.svm.SVC(C=svc_c, gamma=\"auto\")\n","    else:\n","        rf_max_depth = trial.suggest_int(\"rf_max_depth\", 2, 32, log=True)\n","        rf_n_estimators = trial.suggest_int(\"n_estimators\", 10, 100)\n","        classifier_obj = sklearn.ensemble.RandomForestClassifier(\n","            max_depth=rf_max_depth, n_estimators=rf_n_estimators\n","        )\n","\n","    score = sklearn.model_selection.cross_val_score(classifier_obj, X_train, y_train, n_jobs=-1, cv=3)\n","    accuracy = score.mean()\n","    return accuracy\n","\n","\n","\n","study = optuna.create_study(direction=\"maximize\")\n","study.optimize(objective, n_trials=100)\n","\n","\n","# Retrieve the best parameters\n","best_params = study.best_params\n","print(\"Best parameters:\", best_params)"]},{"cell_type":"markdown","metadata":{"id":"b_oxhnXZif66"},"source":["Exercise 3: # Retrain your model with the best parameters."]},{"cell_type":"code","execution_count":null,"metadata":{"id":"QL5-a02GikSL"},"outputs":[],"source":["from sklearn.ensemble import RandomForestClassifier\n","\n","# Retrain your model with the best parameters\n","best_model = RandomForestClassifier(max_depth= best_params['rf_max_depth'], n_estimators=best_params['n_estimators'])\n","best_model.fit(X_train, y_train)\n","\n","# Evaluate the best model on the test dataset\n","test_accuracy = best_model.score(X_test, y_test)\n","print(\"Test accuracy:\", test_accuracy)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"AnQ6RZHNEfb8"},"outputs":[],"source":["# Split dataset into training and testing\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":39681,"status":"ok","timestamp":1741174499747,"user":{"displayName":"Aritz Bilbao Jayo","userId":"07337047788957255346"},"user_tz":-60},"id":"6tuY97cdElYj","outputId":"177a604c-7939-404b-91c4-2054638481e4"},"outputs":[{"name":"stderr","output_type":"stream","text":["[I 2025-03-05 11:33:43,887] A new study created in memory with name: no-name-41ef2a28-4326-439c-a25f-bf09e1e88dc5\n","[I 2025-03-05 11:33:44,782] Trial 0 finished with value: 0.77390527256479 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 7, 'n_estimators': 77}. Best is trial 0 with value: 0.77390527256479.\n","[I 2025-03-05 11:33:44,919] Trial 1 finished with value: 0.7551385165326184 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 3, 'n_estimators': 12}. Best is trial 0 with value: 0.77390527256479.\n","[I 2025-03-05 11:33:45,237] Trial 2 finished with value: 0.6702412868632708 and parameters: {'classifier': 'SVC', 'svc_c': 1846761.1294263052}. Best is trial 0 with value: 0.77390527256479.\n","[I 2025-03-05 11:33:45,415] Trial 3 finished with value: 0.6702412868632708 and parameters: {'classifier': 'SVC', 'svc_c': 5465980306.788197}. Best is trial 0 with value: 0.77390527256479.\n","[I 2025-03-05 11:33:45,559] Trial 4 finished with value: 0.5254691689008043 and parameters: {'classifier': 'SVC', 'svc_c': 0.019164348626687745}. Best is trial 0 with value: 0.77390527256479.\n","[I 2025-03-05 11:33:46,130] Trial 5 finished with value: 0.7587131367292225 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 3, 'n_estimators': 92}. Best is trial 0 with value: 0.77390527256479.\n","[I 2025-03-05 11:33:46,445] Trial 6 finished with value: 0.7837354781054513 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 27, 'n_estimators': 34}. Best is trial 6 with value: 0.7837354781054513.\n","[I 2025-03-05 11:33:46,929] Trial 7 finished with value: 0.7765862377122431 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 6, 'n_estimators': 66}. Best is trial 6 with value: 0.7837354781054513.\n","[I 2025-03-05 11:33:47,262] Trial 8 finished with value: 0.7515638963360143 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 3, 'n_estimators': 51}. Best is trial 6 with value: 0.7837354781054513.\n","[I 2025-03-05 11:33:47,487] Trial 9 finished with value: 0.7828418230563002 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 19, 'n_estimators': 25}. Best is trial 6 with value: 0.7837354781054513.\n","[I 2025-03-05 11:33:47,542] Trial 10 pruned. \n","[I 2025-03-05 11:33:47,644] Trial 11 pruned. \n","[I 2025-03-05 11:33:48,009] Trial 12 finished with value: 0.7828418230563002 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 31, 'n_estimators': 38}. Best is trial 6 with value: 0.7837354781054513.\n","[I 2025-03-05 11:33:48,085] Trial 13 pruned. \n","[I 2025-03-05 11:33:48,472] Trial 14 finished with value: 0.7846291331546024 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 15, 'n_estimators': 41}. Best is trial 14 with value: 0.7846291331546024.\n","[I 2025-03-05 11:33:48,861] Trial 15 finished with value: 0.7792672028596961 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 13, 'n_estimators': 44}. Best is trial 14 with value: 0.7846291331546024.\n","[I 2025-03-05 11:33:49,370] Trial 16 finished with value: 0.7989276139410187 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 10, 'n_estimators': 58}. Best is trial 16 with value: 0.7989276139410187.\n","[I 2025-03-05 11:33:49,571] Trial 17 pruned. \n","[I 2025-03-05 11:33:49,630] Trial 18 pruned. \n","[I 2025-03-05 11:33:50,134] Trial 19 finished with value: 0.7792672028596961 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 10, 'n_estimators': 59}. Best is trial 16 with value: 0.7989276139410187.\n","[I 2025-03-05 11:33:50,351] Trial 20 pruned. \n","[I 2025-03-05 11:33:50,701] Trial 21 finished with value: 0.7917783735478104 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 19, 'n_estimators': 38}. Best is trial 16 with value: 0.7989276139410187.\n","[I 2025-03-05 11:33:51,141] Trial 22 finished with value: 0.7899910634495084 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 20, 'n_estimators': 49}. Best is trial 16 with value: 0.7989276139410187.\n","[I 2025-03-05 11:33:51,624] Trial 23 finished with value: 0.7855227882037533 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 20, 'n_estimators': 54}. Best is trial 16 with value: 0.7989276139410187.\n","[I 2025-03-05 11:33:51,781] Trial 24 pruned. \n","[I 2025-03-05 11:33:52,303] Trial 25 finished with value: 0.7846291331546024 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 11, 'n_estimators': 59}. Best is trial 16 with value: 0.7989276139410187.\n","[I 2025-03-05 11:33:52,359] Trial 26 pruned. \n","[I 2025-03-05 11:33:52,512] Trial 27 pruned. \n","[I 2025-03-05 11:33:52,651] Trial 28 pruned. \n","[I 2025-03-05 11:33:52,766] Trial 29 pruned. \n","[I 2025-03-05 11:33:53,310] Trial 30 finished with value: 0.7890974084003575 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 14, 'n_estimators': 61}. Best is trial 16 with value: 0.7989276139410187.\n","[I 2025-03-05 11:33:53,868] Trial 31 finished with value: 0.7944593386952636 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 15, 'n_estimators': 65}. Best is trial 16 with value: 0.7989276139410187.\n","[I 2025-03-05 11:33:54,595] Trial 32 finished with value: 0.7935656836461126 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 17, 'n_estimators': 84}. Best is trial 16 with value: 0.7989276139410187.\n","[I 2025-03-05 11:33:55,436] Trial 33 finished with value: 0.7837354781054513 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 11, 'n_estimators': 89}. Best is trial 16 with value: 0.7989276139410187.\n","[I 2025-03-05 11:33:56,536] Trial 34 finished with value: 0.7890974084003575 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 12, 'n_estimators': 86}. Best is trial 16 with value: 0.7989276139410187.\n","[I 2025-03-05 11:33:56,645] Trial 35 pruned. \n","[I 2025-03-05 11:33:57,014] Trial 36 pruned. \n","[I 2025-03-05 11:33:57,109] Trial 37 pruned. \n","[I 2025-03-05 11:33:57,526] Trial 38 pruned. \n","[I 2025-03-05 11:33:58,173] Trial 39 finished with value: 0.7944593386952636 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 24, 'n_estimators': 73}. Best is trial 16 with value: 0.7989276139410187.\n","[I 2025-03-05 11:33:58,394] Trial 40 pruned. \n","[I 2025-03-05 11:33:58,974] Trial 41 finished with value: 0.7908847184986595 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 25, 'n_estimators': 66}. Best is trial 16 with value: 0.7989276139410187.\n","[I 2025-03-05 11:33:59,203] Trial 42 pruned. \n","[I 2025-03-05 11:33:59,882] Trial 43 finished with value: 0.7890974084003575 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 23, 'n_estimators': 77}. Best is trial 16 with value: 0.7989276139410187.\n","[I 2025-03-05 11:34:00,430] Trial 44 finished with value: 0.7846291331546024 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 17, 'n_estimators': 63}. Best is trial 16 with value: 0.7989276139410187.\n","[I 2025-03-05 11:34:00,677] Trial 45 pruned. \n","[I 2025-03-05 11:34:00,747] Trial 46 pruned. \n","[I 2025-03-05 11:34:01,347] Trial 47 finished with value: 0.7846291331546024 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 15, 'n_estimators': 69}. Best is trial 16 with value: 0.7989276139410187.\n","[I 2025-03-05 11:34:01,513] Trial 48 pruned. \n","[I 2025-03-05 11:34:02,217] Trial 49 finished with value: 0.7998212689901698 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 29, 'n_estimators': 81}. Best is trial 49 with value: 0.7998212689901698.\n","[I 2025-03-05 11:34:03,005] Trial 50 finished with value: 0.7935656836461126 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 31, 'n_estimators': 91}. Best is trial 49 with value: 0.7998212689901698.\n","[I 2025-03-05 11:34:03,698] Trial 51 finished with value: 0.7917783735478104 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 29, 'n_estimators': 80}. Best is trial 49 with value: 0.7998212689901698.\n","[I 2025-03-05 11:34:03,976] Trial 52 pruned. \n","[I 2025-03-05 11:34:04,782] Trial 53 finished with value: 0.7944593386952636 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 24, 'n_estimators': 94}. Best is trial 49 with value: 0.7998212689901698.\n","[I 2025-03-05 11:34:05,513] Trial 54 finished with value: 0.7935656836461126 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 24, 'n_estimators': 86}. Best is trial 49 with value: 0.7998212689901698.\n","[I 2025-03-05 11:34:05,810] Trial 55 pruned. \n","[I 2025-03-05 11:34:06,047] Trial 56 pruned. \n","[I 2025-03-05 11:34:06,107] Trial 57 pruned. \n","[I 2025-03-05 11:34:06,366] Trial 58 pruned. \n","[I 2025-03-05 11:34:07,185] Trial 59 finished with value: 0.7908847184986595 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 22, 'n_estimators': 94}. Best is trial 49 with value: 0.7998212689901698.\n","[I 2025-03-05 11:34:07,952] Trial 60 finished with value: 0.8016085790884718 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 24, 'n_estimators': 72}. Best is trial 60 with value: 0.8016085790884718.\n","[I 2025-03-05 11:34:08,288] Trial 61 pruned. \n","[I 2025-03-05 11:34:09,118] Trial 62 finished with value: 0.7873100983020554 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 19, 'n_estimators': 64}. Best is trial 60 with value: 0.8016085790884718.\n","[I 2025-03-05 11:34:10,080] Trial 63 finished with value: 0.7899910634495084 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 23, 'n_estimators': 75}. Best is trial 60 with value: 0.8016085790884718.\n","[I 2025-03-05 11:34:10,671] Trial 64 finished with value: 0.7908847184986595 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 18, 'n_estimators': 68}. Best is trial 60 with value: 0.8016085790884718.\n","[I 2025-03-05 11:34:11,424] Trial 65 finished with value: 0.7971403038427166 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 28, 'n_estimators': 86}. Best is trial 60 with value: 0.8016085790884718.\n","[I 2025-03-05 11:34:11,603] Trial 66 pruned. \n","[I 2025-03-05 11:34:12,312] Trial 67 finished with value: 0.7926720285969616 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 27, 'n_estimators': 81}. Best is trial 60 with value: 0.8016085790884718.\n","[I 2025-03-05 11:34:12,565] Trial 68 pruned. \n","[I 2025-03-05 11:34:12,634] Trial 69 pruned. \n","[I 2025-03-05 11:34:12,848] Trial 70 pruned. \n","[I 2025-03-05 11:34:13,120] Trial 71 pruned. \n","[I 2025-03-05 11:34:13,387] Trial 72 pruned. \n","[I 2025-03-05 11:34:13,620] Trial 73 pruned. \n","[I 2025-03-05 11:34:14,411] Trial 74 finished with value: 0.7926720285969616 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 14, 'n_estimators': 93}. Best is trial 60 with value: 0.8016085790884718.\n","[I 2025-03-05 11:34:15,118] Trial 75 finished with value: 0.7899910634495084 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 20, 'n_estimators': 82}. Best is trial 60 with value: 0.8016085790884718.\n","[I 2025-03-05 11:34:15,179] Trial 76 pruned. \n","[I 2025-03-05 11:34:15,382] Trial 77 pruned. \n","[I 2025-03-05 11:34:15,575] Trial 78 pruned. \n","[I 2025-03-05 11:34:15,736] Trial 79 pruned. \n","[I 2025-03-05 11:34:15,800] Trial 80 pruned. \n","[I 2025-03-05 11:34:16,068] Trial 81 pruned. \n","[I 2025-03-05 11:34:16,815] Trial 82 finished with value: 0.7855227882037533 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 26, 'n_estimators': 86}. Best is trial 60 with value: 0.8016085790884718.\n","[I 2025-03-05 11:34:17,539] Trial 83 finished with value: 0.7944593386952636 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 32, 'n_estimators': 83}. Best is trial 60 with value: 0.8016085790884718.\n","[I 2025-03-05 11:34:18,247] Trial 84 finished with value: 0.7899910634495084 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 21, 'n_estimators': 79}. Best is trial 60 with value: 0.8016085790884718.\n","[I 2025-03-05 11:34:18,509] Trial 85 pruned. \n","[I 2025-03-05 11:34:18,714] Trial 86 pruned. \n","[I 2025-03-05 11:34:19,397] Trial 87 finished with value: 0.7926720285969616 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 16, 'n_estimators': 77}. Best is trial 60 with value: 0.8016085790884718.\n","[I 2025-03-05 11:34:19,588] Trial 88 pruned. \n","[I 2025-03-05 11:34:20,223] Trial 89 finished with value: 0.7998212689901698 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 28, 'n_estimators': 62}. Best is trial 60 with value: 0.8016085790884718.\n","[I 2025-03-05 11:34:20,514] Trial 90 pruned. \n","[I 2025-03-05 11:34:21,249] Trial 91 finished with value: 0.7917783735478107 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 32, 'n_estimators': 57}. Best is trial 60 with value: 0.8016085790884718.\n","[I 2025-03-05 11:34:21,562] Trial 92 pruned. \n","[I 2025-03-05 11:34:21,891] Trial 93 pruned. \n","[I 2025-03-05 11:34:22,196] Trial 94 pruned. \n","[I 2025-03-05 11:34:22,329] Trial 95 pruned. \n","[I 2025-03-05 11:34:22,551] Trial 96 pruned. \n","[I 2025-03-05 11:34:23,269] Trial 97 finished with value: 0.7882037533512064 and parameters: {'classifier': 'RandomForest', 'rf_max_depth': 29, 'n_estimators': 84}. Best is trial 60 with value: 0.8016085790884718.\n","[I 2025-03-05 11:34:23,326] Trial 98 pruned. \n","[I 2025-03-05 11:34:23,561] Trial 99 pruned. \n"]},{"name":"stdout","output_type":"stream","text":["Best parameters: {'classifier': 'RandomForest', 'rf_max_depth': 24, 'n_estimators': 72}\n"]}],"source":["import optuna\n","import sklearn.datasets\n","import sklearn.ensemble\n","import sklearn.model_selection\n","import sklearn.svm\n","import pandas as pd\n","\n","def objective(trial):\n","    classifier_name = trial.suggest_categorical(\"classifier\", [\"SVC\", \"RandomForest\"])\n","    if classifier_name == \"SVC\":\n","        svc_c = trial.suggest_float(\"svc_c\", 1e-10, 1e10, log=True)\n","        classifier_obj = sklearn.svm.SVC(C=svc_c, gamma=\"auto\")\n","    else:\n","        rf_max_depth = trial.suggest_int(\"rf_max_depth\", 2, 32, log=True)\n","        rf_n_estimators = trial.suggest_int(\"n_estimators\", 10, 100)\n","        classifier_obj = sklearn.ensemble.RandomForestClassifier(\n","            max_depth=rf_max_depth, n_estimators=rf_n_estimators\n","        )\n","\n","    scores = []\n","    cv = sklearn.model_selection.StratifiedKFold(n_splits=3, shuffle=True, random_state=42) #using StratifiedKfold\n","    for fold, (train_index, val_index) in enumerate(cv.split(X_train, y_train)):\n","        X_train_fold, X_val_fold = X_train.iloc[train_index], X_train.iloc[val_index]\n","        y_train_fold, y_val_fold = y_train.iloc[train_index].values.ravel(), y_train.iloc[val_index].values.ravel()\n","        classifier_obj.fit(X_train_fold, y_train_fold)\n","        score = classifier_obj.score(X_val_fold, y_val_fold)\n","        scores.append(score)\n","        trial.report(score, fold) # Accuracy of each iteration. Fold1 as eval, fold2 as eval and fold3 as eval.\n","        if trial.should_prune():\n","            raise optuna.exceptions.TrialPruned()\n","\n","    accuracy = sum(scores) / len(scores)\n","    return accuracy\n","\n","study = optuna.create_study(direction=\"maximize\", pruner=optuna.pruners.MedianPruner())\n","study.optimize(objective, n_trials=100)\n","\n","best_params = study.best_params\n","print(\"Best parameters:\", best_params)"]}],"metadata":{"colab":{"name":"","provenance":[{"file_id":"1ouiFECvK9EDL0ve43NRvKaTZNtg7Pw09","timestamp":1741370908686}],"version":""},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}